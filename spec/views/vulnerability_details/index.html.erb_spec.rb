require 'rails_helper'

RSpec.describe "vulnerability_details/index", type: :view do
  before(:each) do
    assign(:vulnerability_details, [
      VulnerabilityDetail.create!(
        :name => "Name",
        :nvt => "Nvt",
        :family => "Family",
        :threat => "Threat",
        :severity => "9.99",
        :cves => "Cves",
        :bids => "Bids",
        :xrefs => "Xrefs",
        :  => " "
      ),
      VulnerabilityDetail.create!(
        :name => "Name",
        :nvt => "Nvt",
        :family => "Family",
        :threat => "Threat",
        :severity => "9.99",
        :cves => "Cves",
        :bids => "Bids",
        :xrefs => "Xrefs",
        :  => " "
      )
    ])
  end

  it "renders a list of vulnerability_details" do
    render
    assert_select "tr>td", :text => "Name".to_s, :count => 2
    assert_select "tr>td", :text => "Nvt".to_s, :count => 2
    assert_select "tr>td", :text => "Family".to_s, :count => 2
    assert_select "tr>td", :text => "Threat".to_s, :count => 2
    assert_select "tr>td", :text => "9.99".to_s, :count => 2
    assert_select "tr>td", :text => "Cves".to_s, :count => 2
    assert_select "tr>td", :text => "Bids".to_s, :count => 2
    assert_select "tr>td", :text => "Xrefs".to_s, :count => 2
    assert_select "tr>td", :text => " ".to_s, :count => 2
  end
end
