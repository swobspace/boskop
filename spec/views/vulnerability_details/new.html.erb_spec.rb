require 'rails_helper'

RSpec.describe "vulnerability_details/new", type: :view do
  before(:each) do
    assign(:vulnerability_detail, VulnerabilityDetail.new(
      :name => "MyString",
      :nvt => "MyString",
      :family => "MyString",
      :threat => "MyString",
      :severity => "9.99",
      :cves => "MyString",
      :bids => "MyString",
      :xrefs => "MyString",
      :  => "MyString"
    ))
  end

  it "renders new vulnerability_detail form" do
    render

    assert_select "form[action=?][method=?]", vulnerability_details_path, "post" do

      assert_select "input[name=?]", "vulnerability_detail[name]"

      assert_select "input[name=?]", "vulnerability_detail[nvt]"

      assert_select "input[name=?]", "vulnerability_detail[family]"

      assert_select "input[name=?]", "vulnerability_detail[threat]"

      assert_select "input[name=?]", "vulnerability_detail[severity]"

      assert_select "input[name=?]", "vulnerability_detail[cves]"

      assert_select "input[name=?]", "vulnerability_detail[bids]"

      assert_select "input[name=?]", "vulnerability_detail[xrefs]"

      assert_select "input[name=?]", "vulnerability_detail[ ]"
    end
  end
end
