require "rails_helper"

RSpec.describe VulnerabilityDetailsHelper, :type => :helper do

  describe "#dl_notes" do
    let(:myhash) {{
      "summary" => "a short summary"
    }}
    subject { Capybara.string(helper.dl_notes(myhash)) }
    it { expect(subject.find("dl dt").text).to match("summary") }
    it { expect(subject.find("dl dd").text).to match("a short summary") }
  end

  describe "#link_to_xrefs" do
    let(:xrefs) {[
      "URL:https://hithis",
      "URL:http://hellothere",
    ]}
    subject { Capybara.string(helper.link_to_xrefs(xrefs)) }
    it { expect(subject.all("a").first['href']).to match("https://hithis") }
    it { expect(subject.all("a").last['href']).to match("http://hellothere") }
  end

  describe "#link_to_bids" do
    let(:bids) {[
      "URL:https://hithis",
      "URL:http://hellothere",
    ]}
    subject { Capybara.string(helper.link_to_xrefs(xrefs)) }
    it { expect(subject.all("a").first['href']).to match("https://hithis") }
    it { expect(subject.all("a").last['href']).to match("http://hellothere") }
  end
end
