shared_context "vulnerability variables" do
  let!(:vd1) { FactoryBot.create(:vulnerability_detail, 
               name: '4013389', threat: 'High', severity: '9.3')}
  let!(:vd2) { FactoryBot.create(:vulnerability_detail, 
               name: 'Old MySQL', threat: 'Medium', severity: '6.7')}
  let!(:vd3) { FactoryBot.create(:vulnerability_detail, 
               name: 'Old Service', threat: 'Low', severity: '2.5')}

  let!(:os1) { FactoryBot.create(:operating_system, name: 'ShadowOS',)}
  let!(:os2) { FactoryBot.create(:operating_system, name: 'DummyOS')}
  let!(:os3) { FactoryBot.create(:operating_system, name: 'EverytimeOS')}

  let!(:loc_paris) { FactoryBot.create(:location, name: 'Paris', lid: 'PARIS') }
  let!(:loc_london) { FactoryBot.create(:location, name: 'London', lid: 'LONDON') }
  let!(:loc_berlin) { FactoryBot.create(:location, name: 'Berlin', lid: 'BER') }
  let!(:cat) { FactoryBot.create(:host_category, name: 'Server') }


  let!(:host1) { FactoryBot.create(:host,
    name: 'pc4.my.domain',
    location: loc_berlin,
    operating_system: os1,
  )}
  let!(:host2) { FactoryBot.create(:host,
    name: 'pc5.my.domain',
    location: loc_london,
    operating_system: os2,
  )}
  let!(:host3) { FactoryBot.create(:host,
    name: 'abc.other.domain',
    operating_system: os3,
    location: loc_paris,
    host_category: cat,
  )}
  let!(:if_host1) { FactoryBot.create(:network_interface,
    host: host1,
    ip: '198.51.100.17',
  )}
  let!(:if_host2) { FactoryBot.create(:network_interface,
    ip: '198.51.100.71',
    host: host2,
  )}
  let!(:if_host3) { FactoryBot.create(:network_interface,
    host: host3,
    ip: '192.0.2.17',
  )}

  let!(:vuln11) { FactoryBot.create(:vulnerability, 
    host: host1, 
    vulnerability_detail: vd1,
    plugin_output: "brabbelfasel",
    lastseen: '2017-01-01'
  )}
  let!(:vuln12) { FactoryBot.create(:vulnerability, 
    host: host1, 
    vulnerability_detail: vd2,
    plugin_output: "brabbelfasel",
    lastseen: '2017-03-01'
  )}
  let!(:vuln13) { FactoryBot.create(:vulnerability, 
    host: host1, 
    vulnerability_detail: vd3,
    lastseen: '2017-04-01'
  )}
  let!(:vuln22) { FactoryBot.create(:vulnerability, 
    host: host2, 
    vulnerability_detail: vd2,
    lastseen: '2017-04-01'
  )}
  let!(:vuln23) { FactoryBot.create(:vulnerability, 
    host: host2, 
    vulnerability_detail: vd3,
    lastseen: '2017-05-01'
  )}
  let!(:vuln33) { FactoryBot.create(:vulnerability, 
    host: host3, 
    vulnerability_detail: vd3,
    lastseen: '2017-06-01'
  )}
end
