shared_context "vulnerability variables" do
  let(:vd1) { FactoryGirl.create(:vulnerability_detail, 
               name: '4013389', threat: 'High', severity: '9.3')}
  let(:vd2) { FactoryGirl.create(:vulnerability_detail, 
               name: 'Old MySQL', threat: 'Medium', severity: '6.7')}
  let(:vd3) { FactoryGirl.create(:vulnerability_detail, 
               name: 'Old Service', threat: 'Low', severity: '2.5')}

  let(:os1) { FactoryGirl.create(:operating_system, name: 'ShadowOS',)}
  let(:os2) { FactoryGirl.create(:operating_system, name: 'DummyOS')}
  let(:os3) { FactoryGirl.create(:operating_system, name: 'EverytimeOS')}

  let!(:loc_paris) { FactoryGirl.create(:location, name: 'Paris', lid: 'PARIS') }
  let!(:cat) { FactoryGirl.create(:host_category, name: 'Server') }


  let!(:host1) { FactoryGirl.create(:host,
    name: 'pc4.my.domain',
    ip: '198.51.100.17',
    operating_system: os1,
  )}
  let!(:host2) { FactoryGirl.create(:host,
    name: 'pc5.my.domain',
    ip: '198.51.100.71',
    operating_system: os2,
  )}
  let!(:host3) { FactoryGirl.create(:host,
    name: 'abc.other.domain',
    ip: '192.0.2.17',
    operating_system: os3,
    location: loc_paris,
    host_category: cat,
  )}

  let!(:vuln11) { FactoryGirl.create(:vulnerability, 
    host: host1, 
    vulnerability_detail: vd1,
    lastseen: '2017-01-01'
  )}
  let!(:vuln12) { FactoryGirl.create(:vulnerability, 
    host: host1, 
    vulnerability_detail: vd2,
    lastseen: '2017-03-01'
  )}
  let!(:vuln13) { FactoryGirl.create(:vulnerability, 
    host: host1, 
    vulnerability_detail: vd3,
    lastseen: '2017-04-01'
  )}
  let!(:vuln22) { FactoryGirl.create(:vulnerability, 
    host: host2, 
    vulnerability_detail: vd2,
    lastseen: '2017-04-01'
  )}
  let!(:vuln23) { FactoryGirl.create(:vulnerability, 
    host: host2, 
    vulnerability_detail: vd3,
    lastseen: '2017-05-01'
  )}
  let!(:vuln33) { FactoryGirl.create(:vulnerability, 
    host: host3, 
    vulnerability_detail: vd3,
    lastseen: '2017-06-01'
  )}
end
