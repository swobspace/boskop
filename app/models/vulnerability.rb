class Vulnerability < ApplicationRecord
  # -- associations
  belongs_to :host
  belongs_to :vulnerability_detail

  # -- configuration
  # -- validations and callbacks
  validates :lastseen, presence: true

  def to_s
    "#{vulnerability_detail&.name}"
  end

  scope :high, -> {
    joins(:vulnerability_detail).where(vulnerability_details: {threat: 'High' })
  }

end
