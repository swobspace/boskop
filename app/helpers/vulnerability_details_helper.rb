module VulnerabilityDetailsHelper

  #
  # format: URL:http://anywhere
  #
  def link_to_xrefs(xrefs)
    xrefs.map do |xref|
      type, url = xref.split(/:/, 2)
      case type
      when 'URL'
        link_to "#{url}", url, target: '_blank'
      end
    end.join(', ').html_safe
  end

  #
  # format: "96703"
  #
  def link_to_bids(bids)
    bids.map do |bid|
      url = "http://www.securityfocus.com/bid/#{bid}"
      link_to bid, url, target: '_blank'
    end.join(', ').html_safe
  end

  #
  # format: "CVE-2017-0143"
  #
  def link_to_cves(cves)
    cves.map do |cve|
      # url = "https://cve.mitre.org/cgi-bin/cvename.cgi?name=#{cve}"
      url = "https://www.cvedetails.com/cve/#{cve}/"

      link_to cve, url, target: '_blank'
    end.join(', ').html_safe
  end

  #
  #
  #
  def certs(certlist)
    return "" if certlist.empty?
    certlist = [certlist] if certlist.kind_of? Hash
    certlist.map do |c|
      "#{c['type']}: #{c['id']}"
    end.join("; ").html_safe
  end
end
